# Login for web site
### Jython
```
# _*_ coding: utf8 _*_
from HTTPClient import NVPair, Cookie, CookieModule, CookiePolicyHandler
from net.grinder.plugin.http import HTTPPluginControl, HTTPRequest
from net.grinder.script import Test
from net.grinder.script.Grinder import grinder
from java.util import Date
# Set up a cookie handler to log all cookies that are sent and received. 
class MyCookiePolicyHandler(CookiePolicyHandler): 
    def acceptCookie(self, cookie, request, response): 
        return 1
  
    def sendCookie(self, cookie, request): 
        return 1
  
CookieModule.setCookiePolicyHandler(MyCookiePolicyHandler()) 
 
test1 = Test(1, "checkout home")
request1 = test1.wrap(HTTPRequest(url="http://my.site.com"))
class TestRunner:
    def __init__(self):
        # Login URL
        request = HTTPRequest(url="https://login.site.com")
        ##### reset to the all cookies #####
        threadContext = HTTPPluginControl.getThreadHTTPClientContext() 
        self.cookies = CookieModule.listAllCookies(threadContext) 
        for c in self.cookies: CookieModule.removeCookie(c, threadContext)
        
        # do login
        request.POST("/login/do", ( NVPair("id", "my_id"),NVPair("pw", "my_passwd")));
        ##### save to the login info in cookies #####
        self.cookies = CookieModule.listAllCookies(threadContext)
                
    def __call__(self):
        grinder.statistics.delayReports = 1
        ##### Set to the cookies for login #####
        threadContext = HTTPPluginControl.getThreadHTTPClientContext()
        for c in self.cookies: CookieModule.addCookie(c,threadContext)
        
        ##### Request with login #####
        result = request1.GET("/mypage")
        
        if result.text.count("only my content data") < 0:
            grinder.statistics.forLastTest.success = 0
        else :
            grinder.statistics.forLastTest.success = 1
```
### Groovy
```
import static net.grinder.script.Grinder.grinder
import static org.hamcrest.Matchers.*
import static org.junit.Assert.*
import net.grinder.plugin.http.HTTPPluginControl
import net.grinder.plugin.http.HTTPRequest
import net.grinder.script.GTest
import net.grinder.scriptengine.groovy.junit.GrinderRunner
import net.grinder.scriptengine.groovy.junit.annotation.BeforeProcess
import net.grinder.scriptengine.groovy.junit.annotation.BeforeThread
 
import org.junit.After
import org.junit.Before;
import org.junit.Test
import org.junit.runner.RunWith
 
import HTTPClient.CookieModule
import HTTPClient.HTTPResponse
import HTTPClient.NVPair
 
/**
 * A simple example using the HTTP plugin that shows the retrieval of a
 * single page via HTTP. 
 * 
 * This script is automatically generated by ngrinder.
 * 
 * @author Gisoo Gwon
 */
@RunWith(GrinderRunner)
class Login {
    public static GTest test
    public static HTTPRequest request
    public Object cookies = []
 
    @BeforeProcess
    public static void beforeProcess() {
        HTTPPluginControl.getConnectionDefaults().timeout = 6000
        test = new GTest(1, "login test")
        request = new HTTPRequest()
        test.record(request);
    }
 
    @BeforeThread
    public void beforeThread() {
        grinder.statistics.delayReports=true;
         
        // reset to the all cookies
        HTTPRequest loginReq = new HTTPRequest()
        Object threadContext = HTTPPluginControl.getThreadHTTPClientContext()
        cookies = CookieModule.listAllCookies(threadContext)
        cookies.each {
            CookieModule.removeCookie(it, threadContext)
        }
         
        // do login & save to the login info in cookies 
        NVPair[] params = [new NVPair("id", "MY_ID"), new NVPair("pw", "MY_PASSWORD")];
        HTTPResponse res = loginReq.POST("https://login.site.com/login/do", params);
        cookies = CookieModule.listAllCookies(threadContext)
    }
 
    @Before
    public void before() {
        // set cookies for login state
        Object threadContext = HTTPPluginControl.getThreadHTTPClientContext()
        cookies.each {
            CookieModule.addCookie(it ,threadContext)
            grinder.logger.info("{}", it)
        }
    }
 
    @Test
    public void test(){
        HTTPResponse result = request.GET("http://my.site.com")
 
        if (result.statusCode == 301 || result.statusCode == 302) {
            grinder.logger.warn("Warning. The response may not be correct. The response code was {}.", result.statusCode);
        } else {
            assertThat(result.statusCode, is(200));
        }
    }
}
```

# ETC
- [The Grinder script samples](http://grinder.sourceforge.net/g3/script-gallery.html).

- Do you need a custom dns entry? Need to change the /etc/hosts file in the agents? You can configure target host fields for this. You don't need root permission in agent machines.
    - [How to change DNS](how-to-change-dns)
- Do you need to use your own jar or py? Read followings. 
    - [How to use library](how-to-use-library)
- Do you need to load your own xml or txt file? Read followings. 
    - [How to use resources](how-to-use-resources)
- Do you need to simulate the multiple user scenario in the different run weight?
    - [How to run the multiple tests with different weight](how-to-run-the-multiple-tests-with-different-weight)
    - [How to run the multiple tests with different weight - Groovy Way](How-to-run-the-multiple-tests-with-different-weight---Groovy-way)
- Do you need to adjust the logger level to only see the errors? Read followings.
    - [How to adjust logger level](how-to-adjust-logger-level)
- Do you need to test DB performance? Doesn't nGrinder seems to support this? No.. You can still test it with nGrinder
    - [Using nGrinder to perform db load test](using-ngrinder-to-perform-db-load-test)
- Do you need to parse data retrieved from server? 
    - [How to parse JSON](how-to-parse-json)
    - [How to parse XML](how-to-parse-xml)
- Do you need to define your own statistic? 
    - [User defined statistic in ngrinder](user-defined-statistic-in-ngrinder)
- Do you cope with the big response like movie or file download?
    - [How to handle the big response](how-to-handle-the-big-response)
- Do you want to make each thread act differently?
    - [How to make each thread act differently](how-to-make-each-thread-act-differently)
- Do you need you test a socket.io app?
    - [How to test a socket.io app](Using-nGrinder-to-perform-load-test-for-a-socket.io-app)
    - [How to test a socket.io app - Python version](Using-nGrinder-to-perform-load-test-for-socket.io-app-Python-version)
- Do you want to pass the parameter to the script to modify the behavior without script modification?
    - [How to pass a parameter to the script](how-to-pass-a-parameter-to-the-script)
- Do you want to run tests with the native so or dlls?
    - [How to bind native libraries](how-to-bind-native-libraries)